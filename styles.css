/* ═══════════════════════════════════════
   RESET + TOKENS
═══════════════════════════════════════ */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html { font-size: 16px; }

:root {
  --ink:        #0f1117;
  --ink-soft:   #2a2d35;
  --ink-faint:  #4a4f5c;
  --rule:       rgba(15,17,23,0.12);
  --rule-heavy: rgba(15,17,23,0.35);
  --paper:      #f5f3ef;
  --paper-warm: #edeae3;
  --snow-white: #ffffff;
  --pow:        #1a5ef5;
  --pow-pale:   #e8efff;
  --building:   #7c3aed;
  --quiet:      #64748b;
  --send:       #15803d;
  --avoid:      #dc2626;
  --amber:      #d97706;
  --red:        #dc2626;

  --serif:  'Playfair Display', Georgia, 'Times New Roman', serif;
  --mono:   'IBM Plex Mono', 'Courier New', monospace;
  --sans:   'DM Sans', system-ui, sans-serif;

  /* Motion */
  --spring: cubic-bezier(0.34,1.56,0.64,1);
  --smooth: cubic-bezier(0.25,0.46,0.45,0.94);
}

body {
  font-family: var(--sans);
  background: var(--paper);
  color: var(--ink);
  -webkit-font-smoothing: antialiased;
  min-height: 100vh;
  /* Paper grain texture */
  background-image:
    url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='300' height='300'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.75' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='300' height='300' filter='url(%23n)' opacity='0.025'/%3E%3C/svg%3E");
}

/* ═══════════════════════════════════════
   MASTHEAD — newspaper front page energy
═══════════════════════════════════════ */
.masthead {
  border-bottom: 3px double var(--rule-heavy);
  padding: 1rem 1.5rem 0.85rem;
  position: sticky;
  top: 0;
  z-index: 200;
  background: var(--paper);
  background-image: inherit;
}

.masthead-top {
  display: flex;
  align-items: flex-end;
  justify-content: space-between;
  gap: 1rem;
  margin-bottom: 0.6rem;
}

/* THE NAMEPLATE */
.nameplate {
  display: flex;
  flex-direction: column;
  align-items: flex-start;
}

.nameplate-rule {
  font-family: var(--mono);
  font-size: 0.52rem;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  color: var(--ink-faint);
  line-height: 1;
  margin-bottom: 0.18rem;
}

.nameplate-logo {
  font-family: var(--serif);
  font-size: 2.1rem;
  font-weight: 900;
  letter-spacing: -0.04em;
  color: var(--ink);
  line-height: 0.9;
  display: flex;
  align-items: flex-end;
  gap: 0;
}
.nameplate-logo em {
  color: var(--pow);
  font-style: italic;
}

.nameplate-sub {
  font-family: var(--mono);
  font-size: 0.48rem;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: var(--ink-faint);
  margin-top: 0.22rem;
}
.nameplate-sub-top,
.nameplate-sub-brief { display: block; }
.nameplate-sub-brief { font-weight: 600; }

/* Masthead right — date + nav */
.masthead-right {
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  gap: 0.3rem;
}

.masthead-date {
  font-family: var(--mono);
  font-size: 0.58rem;
  letter-spacing: 0.08em;
  color: var(--ink-faint);
  text-transform: uppercase;
  white-space: nowrap;
}

.masthead-tabs {
  display: flex;
  gap: 0;
  border: 1px solid var(--rule-heavy);
}

.m-tab {
  padding: 0.25rem 0.65rem;
  font-family: var(--mono);
  font-size: 0.56rem;
  font-weight: 600;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  color: var(--ink-faint);
  background: transparent;
  border: none;
  border-right: 1px solid var(--rule-heavy);
  cursor: pointer;
  transition: all 0.15s;
}
.m-tab:last-child { border-right: none; }
.m-tab:hover { background: var(--ink); color: var(--paper); }
.m-tab.active { background: var(--ink); color: var(--paper); }
.m-tab[data-tab="newsletter"] {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 0.3rem;
  white-space: nowrap;
}
.m-tab[data-tab="newsletter"]::after {
  content: "→";
  font-size: 0.78em;
  line-height: 1;
  transform: translateY(1px);
}

/* ═══════════════════════════════════════
   THE DISPATCH — the one input
═══════════════════════════════════════ */
.dispatch-bar {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  border-top: 1px solid var(--rule);
  padding-top: 0.55rem;
}

.dispatch-label {
  font-family: var(--mono);
  font-size: 0.58rem;
  font-weight: 600;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: var(--ink-faint);
  flex-shrink: 0;
  display: flex;
  align-items: center;
  gap: 0.4rem;
}

.dispatch-cursor {
  display: inline-block;
  width: 7px; height: 11px;
  background: var(--pow);
  animation: blink 1.1s step-end infinite;
  vertical-align: middle;
  margin-left: 1px;
  opacity: 0;
}
.dispatch-bar:focus-within .dispatch-cursor { opacity: 1; }
@keyframes blink { 0%,100% { opacity: 1; } 50% { opacity: 0; } }

.dispatch-input {
  flex: 1;
  border: none;
  background: transparent;
  font-family: var(--mono);
  font-size: 0.82rem;
  font-weight: 500;
  color: var(--ink);
  outline: none;
  caret-color: var(--pow);
  padding: 0;
  min-width: 0;
}

/* Prevent iOS Safari auto-zoom on focus */
@media (max-width: 820px) {
  .dispatch-input {
    font-size: 16px;
  }
}
.dispatch-input::placeholder {
  color: var(--ink-faint);
  font-style: italic;
  font-family: var(--serif);
  font-size: 0.88rem;
}

.dispatch-hints {
  display: flex;
  gap: 6px;
  flex-shrink: 0;
}

.d-hint {
  font-family: var(--mono);
  font-size: 0.52rem;
  font-weight: 600;
  letter-spacing: 0.05em;
  text-transform: uppercase;
  color: var(--ink-faint);
  background: var(--paper-warm);
  border: 1px solid var(--rule-heavy);
  padding: 2px 7px;
  cursor: pointer;
  transition: all 0.15s;
  white-space: nowrap;
  user-select: none;
}
.d-hint:hover { background: var(--ink); color: var(--paper); }
.d-hint.fired {
  background: var(--pow);
  border-color: var(--pow);
  color: white;
}

/* Expand button */
.dispatch-expand-btn {
  display: flex;
  align-items: center;
  gap: 4px;
  font-family: var(--mono);
  font-size: 0.52rem;
  font-weight: 600;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: var(--ink-faint);
  background: var(--paper-warm);
  border: 1px solid var(--rule-heavy);
  padding: 2px 8px;
  cursor: pointer;
  transition: all 0.15s;
  flex-shrink: 0;
  margin-left: auto;
  user-select: none;
}
.dispatch-expand-btn:hover { background: var(--ink); color: var(--paper); }
.dispatch-expand-btn.open { background: var(--ink); color: var(--paper); }
.dispatch-expand-btn.open .deb-chevron { display: inline-block; transform: rotate(180deg); }
.deb-chevron { transition: transform 0.2s var(--smooth); display: inline-block; }

/* ─────────────────────────────────────────────
   DISPATCH DRAWER
───────────────────────────────────────────── */
.dispatch-drawer {
  overflow: hidden;
  max-height: 0;
  transition: max-height 0.28s var(--smooth), border-color 0.2s;
  border-top: 0px solid var(--rule);
}
.dispatch-drawer.open {
  max-height: 200px;
  border-top: 1px solid var(--rule);
}

.drawer-inner {
  display: flex;
  gap: 0;
  padding: 0.6rem 0 0.55rem;
  align-items: flex-start;
  overflow-x: auto;
  scrollbar-width: none;
  position: relative;
}
.drawer-inner::-webkit-scrollbar { display: none; }
.dispatch-drawer.open .drawer-inner::before,
.dispatch-drawer.open .drawer-inner::after {
  content: '';
  position: sticky;
  top: 0;
  width: 16px;
  height: 100%;
  pointer-events: none;
  z-index: 3;
}
.dispatch-drawer.open .drawer-inner::before {
  left: 0;
  background: linear-gradient(to right, var(--paper) 12%, rgba(245,243,239,0));
}
.dispatch-drawer.open .drawer-inner::after {
  right: 0;
  margin-left: auto;
  background: linear-gradient(to left, var(--paper) 12%, rgba(245,243,239,0));
}

.drawer-divider {
  width: 1px;
  background: var(--rule);
  align-self: stretch;
  flex-shrink: 0;
  margin: 0 0.85rem;
  opacity: 0;
  transform: translateX(56px);
}

.drawer-col {
  flex-shrink: 0;
  display: flex;
  flex-direction: column;
  gap: 0.38rem;
  opacity: 0;
  transform: translateX(56px);
}

.drawer-col-label {
  font-family: var(--mono);
  font-size: 0.44rem;
  font-weight: 600;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  color: var(--ink-faint);
  line-height: 1;
  padding-bottom: 2px;
  border-bottom: 1px solid var(--rule);
  margin-bottom: 2px;
}

.drawer-chips {
  display: flex;
  flex-wrap: wrap;
  gap: 4px;
  max-width: 260px;
}

.dispatch-drawer.open .drawer-inner.hint-anim .drawer-col,
.dispatch-drawer.open .drawer-inner.hint-anim .drawer-divider {
  animation: drawerSettleIn 0.72s var(--spring) both;
}
.dispatch-drawer.open .drawer-inner.hint-anim .drawer-col:nth-child(odd),
.dispatch-drawer.open .drawer-inner.hint-anim .drawer-divider:nth-child(odd) { --from-x: -22px; }
.dispatch-drawer.open .drawer-inner.hint-anim .drawer-col:nth-child(even),
.dispatch-drawer.open .drawer-inner.hint-anim .drawer-divider:nth-child(even) { --from-x: 22px; }
.dispatch-drawer.open .drawer-inner.hint-anim > :nth-child(1) { animation-delay: 0.00s; }
.dispatch-drawer.open .drawer-inner.hint-anim > :nth-child(2) { animation-delay: 0.04s; }
.dispatch-drawer.open .drawer-inner.hint-anim > :nth-child(3) { animation-delay: 0.08s; }
.dispatch-drawer.open .drawer-inner.hint-anim > :nth-child(4) { animation-delay: 0.12s; }
.dispatch-drawer.open .drawer-inner.hint-anim > :nth-child(5) { animation-delay: 0.16s; }
.dispatch-drawer.open .drawer-inner.hint-anim > :nth-child(6) { animation-delay: 0.20s; }
.dispatch-drawer.open .drawer-inner.hint-anim > :nth-child(7) { animation-delay: 0.24s; }
.dispatch-drawer.open .drawer-inner.hint-anim > :nth-child(8) { animation-delay: 0.28s; }

@keyframes drawerSettleIn {
  0% {
    opacity: 0;
    transform: translateX(var(--from-x, 56px));
  }
  70% {
    opacity: 1;
    transform: translateX(calc(var(--from-x, 56px) * -0.22));
  }
  100% {
    opacity: 1;
    transform: translateX(0);
  }
}

.dispatch-drawer.open .drawer-inner.hint-anim .drawer-col .d-chip {
  animation: drawerChipSettle 0.56s var(--spring) both;
}
.dispatch-drawer.open .drawer-inner.hint-anim .drawer-col .d-chip:nth-child(1) { animation-delay: 0.18s; }
.dispatch-drawer.open .drawer-inner.hint-anim .drawer-col .d-chip:nth-child(2) { animation-delay: 0.22s; }
.dispatch-drawer.open .drawer-inner.hint-anim .drawer-col .d-chip:nth-child(3) { animation-delay: 0.26s; }
.dispatch-drawer.open .drawer-inner.hint-anim .drawer-col .d-chip:nth-child(4) { animation-delay: 0.30s; }
.dispatch-drawer.open .drawer-inner.hint-anim .drawer-col .d-chip:nth-child(5) { animation-delay: 0.34s; }
.dispatch-drawer.open .drawer-inner.hint-anim .drawer-col .d-chip:nth-child(6) { animation-delay: 0.38s; }

@keyframes drawerChipSettle {
  0% {
    opacity: 0;
    transform: translateY(6px) scale(0.96);
  }
  65% {
    opacity: 1;
    transform: translateY(-2px) scale(1.02);
  }
  100% {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

@media (min-width: 980px) {
  .dispatch-clear {
    order: 3;
  }
  .dispatch-hints {
    order: 4;
    margin-left: auto;
  }
  .dispatch-expand-btn {
    order: 5;
    margin-left: 0;
  }
}

/* The chips */
.d-chip {
  font-family: var(--mono);
  font-size: 0.5rem;
  font-weight: 600;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  color: var(--ink-faint);
  background: transparent;
  border: 1px solid var(--rule-heavy);
  padding: 2px 8px;
  cursor: pointer;
  transition: all 0.13s;
  white-space: nowrap;
  user-select: none;
  line-height: 1.6;
}
.d-chip:hover { background: var(--ink); color: var(--paper); border-color: var(--ink); }
.d-chip.fired {
  background: var(--ink);
  color: var(--paper);
  border-color: var(--ink);
}
/* Colored chips */
.d-chip.chip-pow.fired,
.d-chip.chip-pow:hover { background: var(--pow); border-color: var(--pow); color: white; }
.d-chip.chip-storm.fired,
.d-chip.chip-storm:hover { background: var(--building); border-color: var(--building); color: white; }
.d-chip.chip-avoid.fired,
.d-chip.chip-avoid:hover { background: var(--avoid); border-color: var(--avoid); color: white; }
.d-chip.chip-ikon.fired,
.d-chip.chip-ikon:hover { background: #005bac; border-color: #005bac; color: white; }
.d-chip.chip-epic.fired,
.d-chip.chip-epic:hover { background: #0059a6; border-color: #0059a6; color: white; }
.d-chip.chip-indy.fired,
.d-chip.chip-indy:hover { background: #006747; border-color: #006747; color: white; }
.d-chip.chip-indie.fired,
.d-chip.chip-indie:hover { background: var(--ink-soft); border-color: var(--ink-soft); color: white; }

/* Active filter count badge on expand button */
.deb-count {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  background: var(--pow);
  color: white;
  border-radius: 50%;
  width: 12px;
  height: 12px;
  font-size: 0.42rem;
  font-weight: 700;
  margin-left: 2px;
  flex-shrink: 0;
}

.dispatch-clear {
  font-family: var(--mono);
  font-size: 0.55rem;
  color: var(--ink-faint);
  background: none; border: none; cursor: pointer;
  opacity: 0; pointer-events: none;
  transition: opacity 0.15s;
  padding: 2px 6px;
}
.dispatch-clear.on { opacity: 1; pointer-events: auto; }

/* ═══════════════════════════════════════
   THE BRIEF — the actual editorial layout
═══════════════════════════════════════ */
.brief {
  max-width: 1100px;
  margin: 0 auto;
  padding: 0 1.5rem 4rem;
}

/* ── SECTION RULE ── */
.section-rule {
  border: none;
  border-top: 2px solid var(--ink);
  margin: 1.2rem 0 0;
  position: relative;
}

.section-rule::before {
  content: attr(data-label);
  position: absolute;
  top: -0.65rem;
  left: 0;
  font-family: var(--mono);
  font-size: 0.52rem;
  font-weight: 600;
  letter-spacing: 0.14em;
  text-transform: uppercase;
  background: var(--paper);
  padding-right: 8px;
  color: var(--ink-faint);
}

.section-rule::after {
  content: attr(data-count);
  position: absolute;
  top: -0.65rem;
  right: 0;
  font-family: var(--mono);
  font-size: 0.52rem;
  font-weight: 600;
  letter-spacing: 0.08em;
  background: var(--paper);
  padding-left: 8px;
  color: var(--ink-faint);
}

/* ── THE LEAD — top story treatment ──── */
.lead-zone {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 0;
  border-bottom: 1px solid var(--rule);
  margin-bottom: 0;
}

@media (max-width: 680px) { .lead-zone { grid-template-columns: 1fr; } }

.lead-story {
  padding: 1.1rem 1.5rem 1.1rem 0;
  border-right: 1px solid var(--rule);
  position: relative;
}
.lead-story:last-child { border-right: none; padding: 1.1rem 0 1.1rem 1.5rem; }
@media (max-width: 680px) {
  .lead-story { padding: 1rem 0; border-right: none; border-bottom: 1px solid var(--rule); }
  .lead-story:last-child { border-bottom: none; }
}

/* POW signal indicator */
.lead-signal {
  font-family: var(--mono);
  font-size: 0.5rem;
  font-weight: 600;
  letter-spacing: 0.14em;
  text-transform: uppercase;
  display: inline-flex;
  align-items: center;
  gap: 5px;
  margin-bottom: 0.45rem;
}
.lead-signal.pow     { color: var(--pow); }
.lead-signal.building{ color: var(--building); }
.lead-signal.groomed { color: var(--ink-faint); }
.lead-signal.ice     { color: var(--red); }

/* Signal dot */
.sig-dot {
  width: 6px; height: 6px;
  border-radius: 50%;
  flex-shrink: 0;
}
.lead-signal.pow .sig-dot      { background: var(--pow); animation: dotPulse 1.8s ease-in-out infinite; }
.lead-signal.building .sig-dot { background: var(--building); }
.lead-signal.groomed .sig-dot  { background: var(--ink-faint); }
.lead-signal.ice .sig-dot      { background: var(--red); }
@keyframes dotPulse {
  0%,100% { transform: scale(1); opacity: 1; }
  50%     { transform: scale(1.5); opacity: 0.7; }
}

.lead-headline {
  font-family: var(--serif);
  font-size: 1.75rem;
  font-weight: 900;
  line-height: 1.05;
  letter-spacing: -0.025em;
  color: var(--ink);
  margin-bottom: 0.35rem;
}
.lead-headline em {
  font-style: italic;
  color: var(--pow);
}

.lead-deck {
  font-family: var(--serif);
  font-style: italic;
  font-size: 0.88rem;
  color: var(--ink-soft);
  line-height: 1.5;
  margin-bottom: 0.6rem;
}

/* Lead stats — inline, tight */
.lead-stats {
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
}

.lead-stat {
  display: flex;
  flex-direction: column;
  gap: 1px;
}

.lead-stat-val {
  font-family: var(--mono);
  font-size: 1.1rem;
  font-weight: 600;
  color: var(--ink);
  line-height: 1;
  letter-spacing: -0.02em;
}
.lead-stat-val.big { font-size: 1.5rem; color: var(--pow); }

.lead-stat-lbl {
  font-family: var(--mono);
  font-size: 0.48rem;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: var(--ink-faint);
}

/* Forecast bar — sparkline-style */
.forecast-row {
  display: flex;
  gap: 4px;
  margin-top: 0.7rem;
  align-items: flex-end;
}

.forecast-day {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 3px;
  flex: 1;
}

.forecast-bar-wrap {
  width: 100%;
  height: 30px;
  display: flex;
  align-items: flex-end;
}

.forecast-bar {
  width: 100%;
  background: var(--pow);
  border-radius: 2px 2px 0 0;
  min-height: 2px;
  opacity: 0.7;
  transition: height 0.4s var(--smooth);
}
.forecast-bar.trace { background: var(--rule-heavy); opacity: 0.4; }

.forecast-day-lbl {
  font-family: var(--mono);
  font-size: 0.46rem;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  color: var(--ink-faint);
}
.forecast-day-amt {
  font-family: var(--mono);
  font-size: 0.55rem;
  font-weight: 600;
  color: var(--ink-soft);
}

/* ── THE TICKER — ranked list of all resorts ── */
.ticker-zone {
  margin-top: 0;
}

.ticker-header {
  display: grid;
  grid-template-columns: 2rem 1fr 90px 72px 72px 72px 60px;
  gap: 0 0.75rem;
  padding: 0.35rem 0 0.35rem;
  border-bottom: 1px solid var(--rule-heavy);
}

.th {
  font-family: var(--mono);
  font-size: 0.46rem;
  font-weight: 600;
  letter-spacing: 0.14em;
  text-transform: uppercase;
  color: var(--ink-faint);
  white-space: nowrap;
}
.th.right { text-align: right; }
.th.center { text-align: center; }

/* Resort row */
.resort-row {
  display: grid;
  grid-template-columns: 2rem 1fr 90px 72px 72px 72px 60px;
  gap: 0 0.75rem;
  padding: 0.6rem 0;
  border-bottom: 1px solid var(--rule);
  cursor: pointer;
  transition: background 0.12s;
  position: relative;
  align-items: center;
}

.resort-row:hover { background: rgba(26,94,245,0.035); }
.resort-row:active { background: rgba(26,94,245,0.07); }

/* Rank */
.rr-rank {
  font-family: var(--mono);
  font-size: 0.65rem;
  font-weight: 600;
  color: var(--ink-faint);
  text-align: right;
  align-self: center;
  padding-top: 1px;
}

/* Name col */
.rr-name-col {
  display: flex;
  flex-direction: column;
  gap: 2px;
  min-width: 0;
}

.rr-name {
  font-family: var(--serif);
  font-size: 0.95rem;
  font-weight: 700;
  letter-spacing: -0.015em;
  color: var(--ink);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.rr-meta {
  font-family: var(--mono);
  font-size: 0.48rem;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  color: var(--ink-faint);
  display: flex;
  align-items: center;
  gap: 0.4rem;
}

/* Condition pill */
.rr-cond {
  font-family: var(--mono);
  font-size: 0.6rem;
  font-weight: 600;
  letter-spacing: 0.02em;
  color: var(--ink-soft);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  align-self: center;
}

/* Stats cols */
.rr-stat {
  font-family: var(--mono);
  font-size: 0.7rem;
  font-weight: 600;
  color: var(--ink-soft);
  text-align: right;
  align-self: center;
  white-space: nowrap;
}
.rr-stat.snow { color: var(--pow); }
.rr-stat.ice  { color: var(--red); }
.rr-stat.warm { color: var(--amber); }

/* POW indicator — last col */
.rr-pow {
  display: flex;
  justify-content: flex-end;
  align-items: center;
  align-self: center;
}

.pow-pip {
  width: 8px; height: 8px;
  border-radius: 50%;
  background: var(--rule-heavy);
  transition: all 0.2s;
}
.pow-pip.on {
  background: var(--pow);
  box-shadow: 0 0 0 3px var(--pow-pale);
  animation: dotPulse 2s ease-in-out infinite;
}
.pow-pip.building { background: var(--building); }

/* Rating squares — 5 tiny blocks instead of stars */
.rr-rating {
  display: flex;
  gap: 2px;
  align-items: center;
  justify-content: flex-end;
  align-self: center;
}
.rat-sq {
  width: 8px; height: 8px;
  background: var(--rule);
  flex-shrink: 0;
}
.rat-sq.on { background: var(--ink-soft); }
.rat-sq.pow-on { background: var(--pow); }

/* ── ROW EXPANSION — see rich detail panel below ── */

/* ═══════════════════════════════════════
   SAVE BUTTON — satisfying save action
═══════════════════════════════════════ */
.save-btn { position: relative; overflow: hidden; transition: all 0.15s; }

.save-btn.saved {
  background: var(--ink);
  color: var(--paper);
  border-color: var(--ink);
}

.save-btn::before {
  content: '';
  position: absolute;
  inset: 0;
  background: var(--ink);
  transform: translateY(100%);
  transition: transform 0s;
  z-index: 0;
}
.save-btn.flooding::before {
  transform: translateY(0);
  transition: transform 0.22s cubic-bezier(0.22, 1, 0.36, 1);
}
.save-btn span, .save-btn-text { position: relative; z-index: 1; }

@keyframes stampIn {
  0%   { transform: scale(2.5) rotate(-8deg); opacity: 0; }
  60%  { transform: scale(0.88) rotate(2deg); opacity: 1; }
  80%  { transform: scale(1.06) rotate(-1deg); }
  100% { transform: scale(1) rotate(0deg); opacity: 1; }
}
@keyframes stampOut {
  0%   { transform: scale(1); opacity: 1; }
  100% { transform: scale(0.7); opacity: 0; }
}

@keyframes particleFly {
  0%   { transform: translate(0,0) scale(1); opacity: 1; }
  100% { transform: translate(var(--tx), var(--ty)) scale(0); opacity: 0; }
}

.save-particle {
  position: fixed;
  width: 5px; height: 5px;
  background: var(--ink);
  pointer-events: none;
  z-index: 9999;
  animation: particleFly 0.55s var(--smooth) forwards;
}

@keyframes toastUp {
  0%   { transform: translateY(0) scale(1); opacity: 1; }
  70%  { transform: translateY(-28px) scale(1.02); opacity: 1; }
  100% { transform: translateY(-40px) scale(0.95); opacity: 0; }
}
.save-toast {
  position: fixed;
  font-family: var(--mono);
  font-size: 0.58rem;
  font-weight: 600;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: var(--paper);
  background: var(--ink);
  padding: 4px 10px;
  pointer-events: none;
  z-index: 9999;
  white-space: nowrap;
  animation: toastUp 0.65s var(--smooth) forwards;
}

.saved-badge {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  background: var(--pow);
  color: white;
  font-family: var(--mono);
  font-size: 0.42rem;
  font-weight: 700;
  border-radius: 50%;
  width: 13px; height: 13px;
  margin-left: 3px;
  vertical-align: middle;
  animation: stampIn 0.35s var(--spring) both;
}

@keyframes nameFlash {
  0%   { color: var(--ink); }
  30%  { color: var(--pow); }
  100% { color: var(--ink); }
}
.resort-row.just-saved .rr-name {
  animation: nameFlash 0.7s ease-out both;
}

.m-tab .saved-badge { pointer-events: none; }

@keyframes detailIn {
  from { opacity: 0; transform: translateY(-4px); }
  to   { opacity: 1; transform: translateY(0); }
}

/* ═══════════════════════════════════════
   RICH DETAIL PANEL
═══════════════════════════════════════ */
.resort-detail {
  display: none;
  padding: 0 0 0 2.75rem;
  border-bottom: 2px solid var(--ink);
  background: rgba(26,94,245,0.018);
  animation: detailIn 0.22s var(--smooth) both;
}
.resort-row.expanded + .resort-detail { display: block; }

/* Header row */
.det-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  gap: 1rem;
  padding: 0.9rem 1rem 0.7rem 0;
  border-bottom: 1px solid var(--rule);
}
.det-conditions-label {
  font-family: var(--mono);
  font-size: 0.46rem;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  color: var(--ink-faint);
  margin-bottom: 0.2rem;
}
.det-conditions-main {
  font-family: var(--serif);
  font-size: 1.45rem;
  font-weight: 900;
  letter-spacing: -0.02em;
  color: var(--ink);
  line-height: 1.0;
  margin-bottom: 0.35rem;
}
.det-quick-stats {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem 1.2rem;
  font-family: var(--mono);
  font-size: 0.62rem;
  color: var(--ink-soft);
  margin-bottom: 0.3rem;
}
.det-quick-stats strong { color: var(--ink); font-weight: 600; }
.det-nws-brief {
  font-family: var(--mono);
  font-size: 0.58rem;
  color: var(--ink-soft);
  padding: 0.3rem 0.6rem;
  border-left: 2px solid var(--pow);
  background: var(--pow-pale);
  margin-top: 0.35rem;
  line-height: 1.45;
}
.det-nws-brief strong { color: var(--ink); }
.det-confidence {
  font-family: var(--mono);
  font-size: 0.5rem;
  font-weight: 600;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  padding: 3px 8px;
  border: 1px solid;
  white-space: nowrap;
  flex-shrink: 0;
}
.conf-high { color: var(--send); border-color: var(--send); }
.conf-med  { color: var(--amber); border-color: var(--amber); }
.conf-low  { color: var(--red); border-color: var(--red); }

/* Warning banner */
.det-warning {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-family: var(--mono);
  font-size: 0.58rem;
  font-weight: 600;
  padding: 0.4rem 1rem 0.4rem 0;
  margin: 0;
  border-bottom: 1px solid var(--rule);
  letter-spacing: 0.03em;
}
.det-warning.storm { color: var(--building); background: rgba(124,58,237,0.06); }
.det-warning.watch { color: var(--amber); background: rgba(217,119,6,0.06); }
.det-warn-icon { font-size: 0.75rem; }

/* Body — 3 column grid */
.det-body {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 0;
  border-bottom: 1px solid var(--rule);
}
@media (max-width: 860px) { .det-body { grid-template-columns: 1fr 1fr; } }
@media (max-width: 640px) { .det-body { grid-template-columns: 1fr; } }

.det-col {
  padding: 0.75rem 1rem 0.75rem 0;
  border-right: 1px solid var(--rule);
}
.det-col:last-child { border-right: none; }

/* Section within column */
.det-section + .det-section { margin-top: 0.75rem; padding-top: 0.75rem; border-top: 1px solid var(--rule); }
.det-section-head {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 0.5rem;
  margin-bottom: 0.45rem;
}
.det-section-label {
  font-family: var(--mono);
  font-size: 0.46rem;
  font-weight: 600;
  letter-spacing: 0.16em;
  text-transform: uppercase;
  color: var(--ink-faint);
  display: block;
  margin-bottom: 0.45rem;
}
.det-section-head .det-section-label { margin-bottom: 0; }

/* Storm badge */
.det-storm-badge {
  font-family: var(--mono);
  font-size: 0.46rem;
  font-weight: 700;
  letter-spacing: 0.1em;
  padding: 2px 7px;
  color: white;
}
.badge-pow   { background: var(--pow); }
.badge-storm { background: var(--building); }
.badge-quiet { background: var(--ink-faint); }

/* 3-day forecast */
.det-forecast {
  display: flex;
  gap: 0.5rem;
}
.det-fc-day {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
  flex: 1;
}
.det-fc-label {
  font-family: var(--mono);
  font-size: 0.5rem;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: var(--ink-faint);
}
.det-fc-icon {
  width: 22px;
  height: 22px;
  display: flex;
  align-items: center;
  justify-content: center;
  line-height: 1;
}
.det-fc-icon img {
  width: 20px;
  height: 20px;
  object-fit: contain;
  display: block;
  filter: saturate(0.95) contrast(1.05);
}
.det-fc-hi {
  font-family: var(--mono);
  font-size: 0.8rem;
  font-weight: 700;
  color: var(--ink);
}

/* POW watch */
.det-pow-row {
  display: flex;
  gap: 1rem;
  align-items: flex-end;
  margin-bottom: 0.3rem;
}
.det-pow-stat {
  display: flex;
  flex-direction: column;
  gap: 2px;
}
.dpv {
  font-family: var(--mono);
  font-size: 0.88rem;
  font-weight: 700;
  color: var(--ink);
  letter-spacing: -0.02em;
  line-height: 1;
}
.dpv.big { font-size: 1.15rem; color: var(--pow); }
.dpl {
  font-family: var(--mono);
  font-size: 0.44rem;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: var(--ink-faint);
}
.det-pow-meta {
  font-family: var(--mono);
  font-size: 0.54rem;
  color: var(--ink-soft);
  line-height: 1.5;
}
.det-pow-meta strong { color: var(--ink); }

/* Sparkline */
.det-sparkline {
  display: flex;
  align-items: flex-end;
  gap: 2px;
  height: 26px;
  margin-bottom: 0.3rem;
}
.sp-bar {
  flex: 1;
  background: var(--pow);
  opacity: 0.75;
  border-radius: 1px 1px 0 0;
  min-height: 2px;
  transition: opacity 0.15s;
}
.sp-bar.sp-trace { background: var(--rule-heavy); opacity: 0.4; min-height: 1px; }
.sp-bar.sp-past  { opacity: 0.3; }
.sp-bar.sp-now   { opacity: 1; box-shadow: 0 0 0 1px var(--pow); }
.det-spark-range {
  font-family: var(--mono);
  font-size: 0.44rem;
  color: var(--ink-faint);
  letter-spacing: 0.04em;
}
.det-spark-footer {
  display: flex;
  justify-content: space-between;
  font-family: var(--mono);
  font-size: 0.52rem;
  color: var(--ink-soft);
}
.det-spark-footer strong { color: var(--ink); }

/* Footer: IceCoast rating + verdict */
.det-footer {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0.65rem 1rem 0.65rem 0;
  border-bottom: 1px solid var(--rule);
}
.det-rating-label {
  font-family: var(--mono);
  font-size: 0.44rem;
  letter-spacing: 0.16em;
  text-transform: uppercase;
  color: var(--ink-faint);
  margin-bottom: 4px;
}
.det-stars { display: flex; gap: 3px; align-items: center; }
.det-star {
  width: 11px; height: 11px;
  background: var(--rule);
  flex-shrink: 0;
}
.det-star.on { background: var(--ink-soft); }
.det-star.on.pow-on { background: var(--pow); }

/* Verdict badge */
.det-verdict {
  font-family: var(--serif);
  font-style: italic;
  font-size: 1.1rem;
  font-weight: 700;
  padding: 0.25rem 0.85rem;
  border: 2px solid;
  letter-spacing: -0.01em;
  box-shadow: 3px 3px 0 var(--rule-heavy);
}
.verdict-go   { color: var(--ink); border-color: var(--ink); background: var(--paper); }
.verdict-wait { color: var(--building); border-color: var(--building); }
.verdict-meh  { color: var(--ink-faint); border-color: var(--rule-heavy); }

.detail-actions {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.d-btn {
  font-family: var(--mono);
  font-size: 0.58rem;
  font-weight: 600;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  padding: 0.3rem 0.75rem;
  border: 1px solid var(--rule-heavy);
  background: transparent;
  color: var(--ink-soft);
  cursor: pointer;
  transition: all 0.15s;
}
.d-btn:hover { background: var(--ink); color: var(--paper); }
.d-btn.primary {
  background: var(--pow);
  border-color: var(--pow);
  color: white;
}
.d-btn.primary:hover { background: #0d4be0; }

/* ── FOOTER EDITIONS ─────────────── */
.brief-footer {
  border-top: 3px double var(--rule-heavy);
  margin-top: 2rem;
  padding: 0.8rem 1.5rem;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 1rem;
  flex-wrap: wrap;
}

.footer-copy {
  font-family: var(--mono);
  font-size: 0.52rem;
  letter-spacing: 0.06em;
  color: var(--ink-faint);
}

.footer-links {
  display: flex;
  gap: 1rem;
}
.footer-link {
  font-family: var(--mono);
  font-size: 0.52rem;
  letter-spacing: 0.06em;
  color: var(--ink-faint);
  text-decoration: none;
  text-transform: uppercase;
  border-bottom: 1px solid var(--rule);
  transition: color 0.15s, border-color 0.15s;
}
.footer-link:hover { color: var(--pow); border-color: var(--pow); }

/* ═══════════════════════════════════════
   ACTIVE FILTER STATE — top of ticker
═══════════════════════════════════════ */
.active-dispatch {
  display: none;
  font-family: var(--mono);
  font-size: 0.58rem;
  color: var(--ink-faint);
  padding: 0.5rem 0 0.3rem;
  align-items: center;
  gap: 0.5rem;
  flex-wrap: wrap;
  border-bottom: 1px solid var(--rule);
}
.active-dispatch.on { display: flex; }

.d-tag {
  background: var(--ink);
  color: var(--paper);
  padding: 2px 8px;
  font-size: 0.52rem;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  display: flex; align-items: center; gap: 4px;
  cursor: pointer;
  transition: background 0.12s;
}
.d-tag:hover { background: var(--red); }
.d-tag-x { opacity: 0.6; }

.d-tag.pow-tag     { background: var(--pow); }
.d-tag.region-tag  { background: var(--ink-soft); }
.d-tag.pass-tag    { background: var(--ink); }

/* ═══════════════════════════════════════
   MOBILE — collapse to card-like at 480px
═══════════════════════════════════════ */
@media (max-width: 720px) {
  .ticker-header { display: none; }

  .resort-row {
    grid-template-columns: 1.6rem 1fr auto;
    grid-template-rows: auto auto;
    row-gap: 4px;
    column-gap: 0.5rem;
    padding: 0.75rem 0;
  }

  .rr-rank { grid-row: 1 / 3; align-self: center; font-size: 0.58rem; }
  .rr-name-col { grid-column: 2; }
  .rr-cond { grid-column: 2; font-size: 0.55rem; }
  .rr-stat { display: none; }
  .rr-pow { grid-column: 3; grid-row: 1 / 3; align-self: center; }
  .rr-rating { display: none; }

  .resort-detail { padding-left: 1.6rem; }
  .det-header { flex-direction: column-reverse; gap: 0.4rem; }
  .det-body { grid-template-columns: 1fr; }
  .det-col { border-right: none; border-bottom: 1px solid var(--rule); padding-bottom: 0.6rem; }
  .det-col:last-child { border-bottom: none; }
}

@media (max-width: 540px) {
  .masthead { padding: 0.75rem 1rem 0.7rem; }
  .nameplate-logo { font-size: 1.75rem; }
  .nameplate-rule {
    white-space: nowrap;
    font-size: 0.48rem;
    letter-spacing: 0.14em;
  }
  .masthead-date {
    font-size: 0.54rem;
    letter-spacing: 0.07em;
  }
  .brief { padding: 0 1rem 3rem; }
  .lead-zone { display: grid; grid-template-columns: 1fr; } /* stacked on mobile, not hidden */
  .lead-story { padding: 0.85rem 0; border-right: none; border-bottom: 1px solid var(--rule); }
  .lead-story:last-child { border-bottom: none; padding: 0.85rem 0 0; }
  .lead-headline { font-size: 1.45rem; }
  .lead-stats { gap: 0.75rem; }
  .dispatch-hints { display: none; } /* hide top hints on very small — use drawer */
}

/* Print-like weight rhythm */
.lead-zone .lead-story:first-child .lead-headline { font-size: 2.1rem; }

/* Noise animation for live indicator */
@keyframes live-pulse {
  0%,100% { opacity: 1; }
  50% { opacity: 0.4; }
}

.live-dot {
  display: inline-block;
  width: 5px; height: 5px;
  background: var(--red);
  border-radius: 50%;
  margin-right: 4px;
  animation: live-pulse 1.2s ease-in-out infinite;
  vertical-align: middle;
}
